---
title: リレーションシップ-EF デザイナー-EF6
description: リレーションシップ-Entity Framework 6 の EF デザイナー
author: ajcvickers
ms.date: 10/23/2016
uid: ef6/modeling/designer/relationships
ms.openlocfilehash: 0211eb1916a7372874f0b7812c512e6eeba0974f
ms.sourcegitcommit: 0a25c03fa65ae6e0e0e3f66bac48d59eceb96a5a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/14/2020
ms.locfileid: "92066136"
---
# <a name="relationships---ef-designer"></a>リレーションシップ-EF デザイナー
> [!NOTE]
> このページでは、EF デザイナーを使用してモデル内のリレーションシップを設定する方法について説明します。 EF のリレーションシップに関する一般的な情報と、リレーションシップを使用してデータにアクセスして操作する方法については、「 [リレーションシップ & ナビゲーションプロパティ](xref:ef6/fundamentals/relationships)」を参照してください。

アソシエーションは、モデル内のエンティティ型間のリレーションシップを定義します。 このトピックでは、Entity Framework Designer (EF デザイナー) との関連付けをマップする方法について説明します。 次の図は、EF デザイナーを操作するときに使用されるメインウィンドウを示しています。

![EF デザイナー](~/ef6/media/efdesigner.png)

> [!NOTE]
> 概念モデルをビルドすると、マップされていないエンティティとアソシエーションについての警告が [エラー一覧] に表示される場合があります。 モデルからデータベースを生成することを選択すると、エラーが解消されるため、これらの警告は無視してかまいません。

## <a name="associations-overview"></a>アソシエーションの概要

EF デザイナーを使用してモデルをデザインすると、.edmx ファイルがモデルを表します。 .Edmx ファイルでは、 **Association** 要素は2つのエンティティ型間のリレーションシップを定義します。 アソシエーションでは、リレーションシップに関連するエンティティ型、およびリレーションシップの各 End におけるエンティティ型の数 (多重度と呼ばれる) を指定する必要があります。 アソシエーション end の複数要素の接続性には、1 (1)、0または 1 (0 ..1)、または many () を指定でき \* ます。 この情報は、2つの子 **End** 要素で指定されます。

実行時に、アソシエーションの一方の end にあるエンティティ型のインスタンスには、ナビゲーションプロパティまたは外部キーを使用してアクセスできます (エンティティで外部キーを公開する場合)。 外部キーが公開されている場合、エンティティ間のリレーションシップは、オブジェクト ( **Association**要素の子要素 **) を使用**して管理されます。 エンティティ内のリレーションシップに対しては、常に外部キーを公開することをお勧めします。

> [!NOTE]
> 多対多 ( \* :) では \* 、エンティティに外部キーを追加することはできません。 \*: リレーションシップで \* は、関連付け情報は独立したオブジェクトで管理されます。

CSDL 要素の詳細について**は、「** csdl の[仕様](xref:ef6/modeling/designer/advanced/edmx/csdl-spec) **」を参照**してください。

## <a name="create-and-delete-associations"></a>関連付けの作成と削除

EF デザイナーとの関連付けを作成すると、.edmx ファイルのモデルコンテンツが更新されます。 アソシエーションを作成した後、アソシエーションのマッピングを作成する必要があります (このトピックで後述します)。

> [!NOTE]
> このセクションでは、モデル間の関連付けを作成するために必要なエンティティを既に追加していることを前提としています。

### <a name="to-create-an-association"></a>アソシエーションを作成するには

1.  デザイン画面の空の領域を右クリックし、[ **新規追加**] をポイントして、[ **関連付け...**] を選択します。
2.  [ **関連付けの追加** ] ダイアログボックスで、アソシエーションの設定を入力します。

    ![関連付けの追加](~/ef6/media/addassociation.png)

    > [!NOTE]
    > ナビゲーションプロパティを **クリアし、 ** **外部キープロパティを &lt; エンティティ型名 &gt; エンティティ **のチェックボックスに追加することで、アソシエーションの end のエンティティにナビゲーションプロパティまたは外部キープロパティを追加しないように選択できます。 ナビゲーション プロパティを 1 つだけ追加する場合、アソシエーションの検査は一方向のみ可能になります。 ナビゲーション プロパティを追加しない場合、アソシエーションの End にあるエンティティにアクセスするには、外部キー プロパティを追加する必要があります。
    
3.   **[OK]** をクリックします。

### <a name="to-delete-an-association"></a>アソシエーションを削除するには

関連付けを削除するには、次のいずれかの操作を行います。

-   EF デザイナー画面でアソシエーションを右クリックし、[ **削除**] を選択します。

- または -

-   1 つまたは複数のアソシエーションを選択し、Del キーを押します。

## <a name="include-foreign-key-properties-in-your-entities-referential-constraints"></a>エンティティに外部キーのプロパティを含める (参照に関する制約)

エンティティ内のリレーションシップに対しては、常に外部キーを公開することをお勧めします。 Entity Framework は、参照に関する制約を使用して、プロパティがリレーションシップの外部キーとして機能することを識別します。

リレーションシップの作成時に [ ***外部キーのプロパティを &lt; エンティティ型名 &gt; エンティティに追加する*** ] チェックボックスをオンにした場合は、この参照制約が追加されています。

EF デザイナーを使用して参照に関する制約を追加または編集すると、EF デザイナーによって .edmx ファイルの CSDL コンテンツの参照先要素**が追加または変更**されます。  

-   編集するアソシエーションをダブルクリックします。
    [ **参照に関する制約**   ] ダイアログボックスが表示されます。
-   [ **プリンシパル**   ] ドロップダウンリストから、参照制約のプリンシパルエンティティを選択します。
    エンティティのキープロパティがダイアログボックスの [ **プリンシパルキー**] の一覧に追加され   ます。
-   [ **依存**   ] ドロップダウンリストから、参照に関する制約の依存エンティティを選択します。
-   依存キーを持つ各プリンシパルキーについて、 **依存**キー列のドロップダウンリストから対応する依存キーを選択し   ます。

    ![Ref 制約](~/ef6/media/refconstraint.png)

-    **[OK]** をクリックします。

## <a name="create-and-edit-association-mappings"></a>アソシエーションのマッピングを作成および編集する

EF デザイナーの [**マッピングの詳細**] ウィンドウで、アソシエーションがデータベースにどのようにマップされるかを指定でき   ます。

> [!NOTE]
> 参照制約が指定されていないアソシエーションについてのみ、詳細をマップできます。 参照制約が指定されている場合は、外部キープロパティがエンティティに含まれます。また、エンティティのマッピング詳細を使用して、外部キーのマップ先の列を制御できます。

### <a name="create-an-association-mapping"></a>アソシエーションのマッピングを作成する

-   デザイン画面でアソシエーションを右クリックし、[ **テーブルマッピング**] を選択します。
    これにより、[マッピングの **詳細**] ウィンドウにアソシエーションのマッピングが表示され   ます。
-   [ **テーブルまたはビューの追加] を**クリックします。
    ストレージ モデル内のすべてのテーブルを示すドロップダウン リストが表示されます。
-   アソシエーションがマップされるテーブルを選択します。
    [ **マッピングの詳細**   ] ウィンドウには、アソシエーションの両端と、各**End**のエンティティ型のキープロパティが表示されます。
-   キープロパティごとに、 **列**   フィールドをクリックし、プロパティがマップされる列を選択します。

    ![マッピングの詳細4](~/ef6/media/mappingdetails4.png)

### <a name="edit-an-association-mapping"></a>アソシエーションのマッピングを編集する

-   デザイン画面でアソシエーションを右クリックし、[ **テーブルマッピング**] を選択します。
    これにより、[マッピングの **詳細**] ウィンドウにアソシエーションのマッピングが表示され   ます。
-   [ ** &lt; テーブル名 &gt; にマップ] を**クリックします。
    ストレージ モデル内のすべてのテーブルを示すドロップダウン リストが表示されます。
-   アソシエーションがマップされるテーブルを選択します。
    [ **マッピングの詳細**   ] ウィンドウには、アソシエーションの両端と、各 End のエンティティ型のキープロパティが表示されます。
-   キープロパティごとに、 **列**   フィールドをクリックし、プロパティがマップされる列を選択します。

## <a name="edit-and-delete-navigation-properties"></a>ナビゲーションプロパティの編集と削除

ナビゲーションプロパティは、モデル内のアソシエーションの end でエンティティを検索するために使用されるショートカットプロパティです。 ナビゲーション プロパティは、2 つのエンティティ型の間のアソシエーションを作成するときに作成できます。

#### <a name="to-edit-navigation-properties"></a>ナビゲーションプロパティを編集するには

-   EF デザイナー画面でナビゲーションプロパティを選択します。
    ナビゲーションプロパティに関する情報は、Visual Studio の [ **プロパティ**] ウィンドウに表示され   ます。
-   [ **プロパティ**] ウィンドウでプロパティの設定を変更し   ます。

#### <a name="to-delete-navigation-properties"></a>ナビゲーションプロパティを削除するには

-   外部キーが概念モデルのエンティティ型で公開されない場合、ナビゲーション プロパティを削除すると、対応するアソシエーションの検査が一方向のみ可能になるか、またはまったく検査できなくなる可能性があります。
-   EF デザイナー画面でナビゲーションプロパティを右クリックし、[ **削除**] を選択します。
